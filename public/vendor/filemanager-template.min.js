!function(){"use strict";var e,t;function r(e){var t,r=fmWrapper.querySelector(".theme-option[data-theme="+e+"]");r&&(fmWrapper.querySelectorAll(".theme-option").forEach(function(e){e.classList.remove("selected")}),r.classList.add("selected"),t=[],fmWrapper.querySelectorAll(".theme-option").forEach(function(e){t.push(e.getAttribute("data-theme"))}),fmWrapper.classList.forEach(function(e){t.forEach(function(e){fmWrapper.classList.remove(e)})}),fmWrapper.classList.add(e),localStorage.setItem("fm-theme",e))}window.fmWrapper=document.querySelector(".fm-wrapper"),Element.prototype.closest||((e=Element.prototype).matches||(e.matches=e.msMatchesSelector||e.webkitMatchesSelector),e.closest=function(e){var t=this;if(t.matches(e))return t;for(;t.parentElement;){var r=t.parentElement;if(r.matches(e))return r;t=t.parentElement}}),NodeList.prototype.forEach||(NodeList.prototype.forEach=function(e,t){for(var r=0;r<this.length;r++)e.call(t,this[r],r,this)}),"classList"in HTMLElement.prototype&&!("forEach"in document.createElement("_").classList)&&(DOMTokenList.prototype.forEach=function(e,t){for(var r=0;r<this.length;r++)e.call(t,this[r],r,this)}),"classList"in document.createElement("_")||((t=function(e){e.className.split(" ").forEach(function(e){this.push(e)}.bind(this)),this._update=function(){e.setAttribute("class",this.join(" "))}}).prototype=Array.prototype,classListProto=t.prototype,classListProto.add=function(){for(var e=0;e<arguments.length;e++)this.contains(arguments[e])||this.push(arguments[e]);this._update()},classListProto.remove=function(){for(var e=0;e<arguments.length;e++)for(var t=0;t<this.length;t++)this[t]===arguments[e]&&this.splice(t,1);this._update()},classListProto.item=function(e){return this[e]},classListProto.contains=function(e){return-1!==this.indexOf(e)},classListProto.toggle=function(e){this.contains(e)?this.remove(e):this.add(e)},Object.defineProperty(window.Element.prototype,"classList",{get:function(){return new t(this)},enumerable:!0,configurable:!0})),localStorage.getItem("fm-theme")&&r(localStorage.getItem("fm-theme")),fmWrapper.querySelectorAll(".theme-option").forEach(function(e){e.addEventListener("click",function(){r(this.getAttribute("data-theme"))})}),window.addEventListener("DOMContentLoaded",function(){fmWrapper.querySelectorAll(".loading").forEach(function(e){e.classList.remove("loading")})});var o=fmWrapper.querySelector("#fm-editor"),n=o.querySelector(".line-numbers"),c=o.querySelector(".content-area"),i=o.querySelector(".pending");function a(){var e=c.value.split("\n").length;n.innerHTML="";for(var t,r,o=0;o<e;o++)t=o+1,r=void 0,(r=document.createElement("span")).textContent=t,n.appendChild(r);c.style.height=window.getComputedStyle(n).getPropertyValue("height")}["input","paste"].forEach(function(e){c.addEventListener(e,a)});function l(e,r,o){document.addEventListener(e,function(e){e.target.matches(r)&&o(e);for(var t=e.target.parentElement;null!==t;)t.matches(r)&&o(e),t=t.parentElement})}a(),window.fmEditor=new function(){this.set=function(e){return c.value=e,a(),this},this.append=function(e){return c.value+=e,a(),this},this.get=function(){return c.value},this.clear=function(){return c.value="",a(),this},this.showLoading=function(){return i.classList.add("show"),this},this.hideLoading=function(){return i.classList.remove("show"),this}},fmWrapper.querySelector(".toggle-slidebar").addEventListener("click",function(){document.querySelector(".slidebar").classList.toggle("show")}),fmWrapper.addEventListener("click",function(e){(e.target.closest(".slidebar")||e.target.closest(".toggle-slidebar")||e.target.closest(".settings-modal")||e.target.closest(".modal-overlay"))&&!e.target.closest('.settings-modal button[data-close="modal"]')||fmWrapper.querySelector(".slidebar").classList.remove("show")});var s=fmWrapper.querySelector(".files-table"),f=s.querySelector(".files-select-all"),d=fmWrapper.querySelector(".toolbar .files-select"),u=fmWrapper.querySelector(".toolbar .files-unselect"),m=fmWrapper.querySelectorAll(".right-buttons *[data-action]");function p(){return s.querySelectorAll(".file-item:not(.hide-in-search)")}function h(){return s.querySelectorAll(".file-item.selected")}function y(){return s.querySelectorAll('.file-item .checkbox input[type="checkbox"]')}function v(t){var e=y();f.checked=t,[].forEach.call(e,function(e){e.checked=t,e.closest(".file-item").classList[t?"add":"remove"]("selected")})}function g(t,r){var o={file:[],dir:["edit","download"],collection:["edit","rename","move","permissions","info"]};h().forEach(function(e){"dir"===e.getAttribute("data-type")&&o.collection.push("download")}),m.forEach(function(e){r&&-1!==o[r].indexOf(e.getAttribute("data-action"))?e.disabled=!0:e.disabled=!t});var e=o.collection.indexOf("download");o.collection.splice(e,1)}function E(){var e=h(),t=p();f.checked=t.length===e.length}l("click",".files-table .file-item",function(e){var t,r,o;e.target.closest(".checkbox")||(e.shiftKey||e.ctrlKey||(t=h(),r=y(),t.forEach(function(e){e.classList.remove("selected")}),r.forEach(function(e){e.checked=!1})),f.checked=!1,(o=e.target.closest(".file-item")).classList.add("selected"),g(o.querySelector('.checkbox input[type="checkbox"]').checked=!0,o.closest(".file-item").getAttribute("data-type")),E())}),l("change",'.file-item .checkbox input[type="checkbox"]',function(e){e.target.closest(".file-item").classList.toggle("selected");var t=h();1<t.length?g(!0,"collection"):1===t.length?g(!0,t[0].getAttribute("data-type")):g(!1),E()}),f.addEventListener("change",function(){this.checked?(v(!0),g(!0,"collection")):(v(!1),g(!1))}),d.addEventListener("click",function(){v(!0),g(!0,"collection")}),u.addEventListener("click",function(){v(!1),g(!1)}),fmWrapper.addEventListener("click",function(e){(e.target.closest(".files-table")||e.target.closest(".files-select")||e.target.closest(".files-unselect")||e.target.closest(".footer")||e.target.closest(".modal"))&&!e.target.closest('*[data-close="modal"]')||(v(!1),g(!1))}),window.addEventListener("keyup",function(e){var t,r,o,n,c="Up"===e.key||"ArrowUp"===e.key,i="Down"===e.key||"ArrowDown"===e.key,a=p();!c&&!i||fmWrapper.querySelector(".modal.show")||(1<=(t=function(){for(var e=p(),t=fmWrapper.querySelector(".files-table .file-item.selected"),r=0;r<e.length;r++)if(e[r]===t)return r+1;return-1}())&&t!==a.length&&i?t++:1<t&&c?t--:t=1===t&&c?a.length:1,v(!1),r=t,o=fmWrapper.querySelector(".files-table .file-item:nth-child("+r+")"),n=o.querySelector('.checkbox input[type="checkbox"]'),g(!0,o.getAttribute("data-type")),o.classList.add("selected"),n.checked=!0)});var L=document.createElement("div");L.classList.add("modal-overlay"),fmWrapper.appendChild(L),fmWrapper.querySelectorAll("*[data-modal]").forEach(function(e){e.addEventListener("click",function(){fmWrapper.querySelector(this.getAttribute("data-modal")).classList.add("show"),L.classList.add("show")})}),fmWrapper.querySelectorAll('*[data-close="modal"]').forEach(function(e){e.addEventListener("click",function(){this.closest(".modal").classList.remove("show"),L.classList.remove("show")})}),fmWrapper.querySelector(".header .search-form .search-input").addEventListener("input",function(){var t=this.value.toLowerCase();fmWrapper.querySelectorAll(".files-table .file-item").forEach(function(e){-1!==e.querySelector(".file-name").textContent.toLowerCase().indexOf(t)?e.classList.remove("hide-in-search"):e.classList.add("hide-in-search")})});var S=fmWrapper.querySelector("#moveFileModal");l("click","#moveFileModal .files-list .item",function(t){var e=t.target.closest(".item");[function(e){var t=e.target.closest(".dir-item");{var r;this===t&&((r=S.querySelector(".files-list .item.selected"))&&r.classList.remove("selected"),t.parentNode.childNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE&&e!==t&&(e.setAttribute("data-open","false"),e.querySelectorAll('.item[data-open="true"]').forEach(function(e){e.setAttribute("data-open","false")}))}),this.classList.add("selected"),this.setAttribute("data-open","true"))}},function(e){var t=S.querySelector(".destination");if(this===e.target.closest(".dir-item")){var r=this,o=r.querySelector(".name").textContent;for(r=r.parentElement.parentElement;r.classList.contains("dir-item");)o=r.querySelector(".name").textContent+"/"+o,r=r.parentElement.parentElement;t.textContent=o}}].forEach(function(e){e.call(this,t)}.bind(e))}),fmWrapper.querySelector('*[data-action="move"]').addEventListener("click",function(){var e;e=fmWrapper.querySelector(".files-table .file-item.selected .file-name"),fmWrapper.querySelector("#moveFileModal .moving-to .source").textContent=e.textContent}),fmWrapper.querySelector('*[data-action="remove"]').addEventListener("click",function(){var e=fmWrapper.querySelectorAll(".files-table .file-item.selected"),t=fmWrapper.querySelector("#removeFileModal .filename");1===e.length?t.textContent=e[0].querySelector(".file-name").textContent:t.textContent="("+e.length+") files"}),fmWrapper.querySelector('*[data-action="rename"]').addEventListener("click",function(){var e=fmWrapper.querySelector(".files-table .file-item.selected");fmWrapper.querySelector("#renameFileModal .name-for").textContent=e.querySelector(".file-name").textContent});var b=[0,0,0],q={read:4,write:2,execute:1};fmWrapper.querySelectorAll(".perm-table .checkbox").forEach(function(e){e.addEventListener("change",function(){b=[0,0,0],e.querySelector("input").checked||e.querySelector("input").removeAttribute("checked"),fmWrapper.querySelectorAll('.perm-table .checkbox input[type="checkbox"]').forEach(function(e){var t=e.closest(".checkbox").getAttribute("data-group"),r=e.closest(".checkbox").getAttribute("data-action");switch(t){case"owner":e.checked&&(b[0]+=q[r]);break;case"group":e.checked&&(b[1]+=q[r]);break;case"others":e.checked&&(b[2]+=q[r])}}),fmWrapper.querySelector(".permissions-modal .numeric-chmod").textContent="0"+b.join("")})}),fmWrapper.querySelector('*[data-action="permissions"]').addEventListener("click",function(){var e=fmWrapper.querySelector(".files-table .file-item.selected");fmWrapper.querySelector("#permissionsModal .filename").textContent=e.querySelector(".file-name").textContent}),l("click",".remove-upload-file",function(e){e.target.closest(".file-item").remove()})}();